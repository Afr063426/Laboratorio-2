---
output:
  pdf_document:
    toc: true
    toc_depth: 2
    includes:
      in_header: preambulo.tex
      before_body: titulo.tex
     
documentclass: memoir
classoption: oneside

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE, include=FALSE, warning=FALSE}
library(readxl)
library(readr)
library(dplyr)
library(plyr)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(readxl)
library(kableExtra)
library(knitr)
library(xtable)
library(gridExtra)
require(xts)
require(YieldCurve)
data(YieldCurve)
datos<-read.csv('C:/Users/saac9/Desktop/bond-yields-us-10y_zip/data/monthly_csv.csv')
datos<-cbind(datos,seq(1:length(datos[,1])))
```
\chapter*{Instrucciones}
A continuación se le indica la estructura de este laboratorio, desglosado por capítulos que debe incluir en el documento pdf de RMarkdown. Este laboratorio es una simulación en cuanto a la estructura del proyecto de investigación que se desarrollará en el curso. 

Tome en cuenta, que al ser este un reporte de laboratorio, no debe ser muy extenso, debe contener un máximo de `r 1+1+1+3+5+1+1 ` páginas, del conteo se excluye la portada, el índice y los anexos.

Este laboratorio se realizará en parejas nuevamente. 

La idea es implementar prácticamente los conceptos aprendido en el capítulos de instrumentos de renta fija y de ser posible ampliar detalles, para ello se le dará la libertad de elegir una de las siguientes opciones generales para llevar a cabo este laboratorio:

\begin{itemize}
\item Calcular una curva de rendimiento con Splines.
\item Calcular una curva de rendimiento con SpliNelson-Siegel (o Svensson). 
\item Calcular una curva de rendimiento en 3D.
\end{itemize}

Dado que tiene libertad para escoger el modelo, también cuenta con libertad para elegir datos que le permitan hacer la respectiva modelación, puede investigar datos con los que cuenta R.





\chapter{Resumen Ejecutivo}
Aquí debe dar resultados generales de lo que obtuvo del análisis.

\chapter{Introducción}

\chapter{Objetivos}
De acuerdo con el modelo elegido, datos encontrados, indique qué quiere conseguir mediante el planteo de un objetivo general (concreto) y unos cuantos objetivos específicos que le ayuden a dividir la tarea grande en pequeñas tareas. 


\section{Objetivo general}
\section{objetivos específicos}


\chapter{Marco teórico}
Detallado pero conciso.

\chapter{Descripción de los datos}
Debe ser una descripción breve e incluir algún gráfico que permita tener una buena comprensión de sus datos.

Entre las descripciones de las variables sería bueno el detalle de la que considera la más importante de su modelo, puede que tenga que calcular la media, por ejemplo, si mis datos son 

``` {r echo=FALSE, message=FALSE, warning=FALSE}
dat<- c(1:4)

kable(dat  , format = "latex" , booktabs=TRUE , align = 'clcc' , caption = "Ejemplo de formato para tabla",)%>%
  kable_styling(full_width = F, position = "center", latex_options = "HOLD_position")
```

\chapter{Metodología}
Cómo implementa la teoría expuesta en el marco teórico con sus datos, colocaremos aquí los resultados que se vayan obteniendo, incluir al menos un gráfico.



\chapter{Conclusiones y recomendaciones}

\chapter{Referencias bibliográficas}
En formato apa.

\chapter{Anexos}


``` {r echo=FALSE, message=FALSE, warning=FALSE}

###Función para calcular los tasas de rendimiento que tenemos
###Se le ingresa el precio del bono y lo que se recibe
rendimientos<-function(precio,pago){
  pago/precio-precio
}
### Modelo Nelson Siegel para rendimientos

NS<-function(theta,tiempo){
  yield<-(theta[1]+(theta[2]+theta[3]/theta[4])*(1-exp(-theta[4]*tiempo))/(theta[4]*tiempo)-theta[3]/theta[4]*exp(-theta[4]*tiempo))
  yield
}

## Se debe ajustar la curva entonces esto se hace
fitNS<-function(theta,tiempo,rendimientos){
  fn<-function(theta){
    sum((rendimientos-NS(theta,tiempo))^2)
  }
  optim(theta,
        fn,
        method = "L-BFGS-B",
        lower= rep(0,4),
        upper=rep(1,4)
        )
}

##

t<-c(0,0,0,0.03)
fit<-fitNS(t,datos[c(2:6),3],datos[c(2:6),2]/100)
parametros<-as.numeric(unlist(fit[1]))
time<-seq(1,6,length=100)

ggplot()+geom_line(aes(x=time,3],y=NS(parametros,time)))
```


