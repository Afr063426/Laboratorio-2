---
output:
  pdf_document:
    toc: true
    toc_depth: 2
    includes:
      in_header: preambulo.tex
      before_body: titulo.tex
     
documentclass: memoir
classoption: oneside

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE, include=FALSE, warning=FALSE}


###Se cargan los paquetes y se cargan y limpian los datos
library(tidyverse)
library(ggplot2)
library(kableExtra)
library(knitr)
library(xtable)
library(gridExtra)
require(xts)
require(YieldCurve)
library(Quandl)
datos<-Quandl("USTREASURY/YIELD")
datos$Date<-(as.Date(datos$Date,format="%Y %m %d"))
datos<-datos[order(datos$Date),]
datos<-datos[datos$Date>=as.Date("2010-01-01"),-3]
### Se procede a calcular la media de las tasas de rendimiento
promedios<-datos%>%select(-1)%>%gather("Maduration","Rendimiento")%>%group_by(Maduration)%>%summarise_all(mean)
### Se pasan los rendimientos a meses
promedios$Maduration<-as.numeric(str_remove_all(promedios$Maduration,"[YRMO ]"))*(str_detect(promedios$Maduration,"YR")*12+str_detect(promedios$Maduration,"MO"))
promedios<-promedios[order(promedios$Maduration),]
```


``` {r echo=FALSE, message=FALSE, warning=FALSE}
### Se program las funciones que se van emplear
##Modelo de Nelson-Siegel para curvas de rendimiento
NS<-function(theta,tiempo){
  yield<-(theta[1]+(theta[2]+theta[3]/theta[4])*(1-exp(-theta[4]*tiempo))/(theta[4]*tiempo)-theta[3]/theta[4]*exp(-theta[4]*tiempo))
  yield
}

## Se debe ajustar la curva entonces esto se busca reducir la suma de cuadrados, con la siguiente funci'on
fitNS<-function(theta,tiempo,rendimientos){
  fn<-function(theta){
    sum((rendimientos-NS(theta,tiempo))^2)
  }
  optim(theta,
        fn,
        method = "L-BFGS-B",
        lower= rep(-1,4),
        upper=rep(1,4)
        )
}

```


\chapter{Resumen Ejecutivo}
Aquí debe dar resultados generales de lo que obtuvo del análisis.

\chapter{Introducción}

\chapter{Objetivos}
De acuerdo con el modelo elegido, datos encontrados, indique qué quiere conseguir mediante el planteo de un objetivo general (concreto) y unos cuantos objetivos específicos que le ayuden a dividir la tarea grande en pequeñas tareas. 


\section{Objetivo general}
\section{objetivos específicos}


\chapter{Marco teórico}
La curva de rendimiento es una herramienta útil a la hora de quererse invertir o negociar un instrumento financiero y al momento de aplicar políticas monetarias.

\chapter{Descripción de los datos}
Debe ser una descripción breve e incluir algún gráfico que permita tener una buena comprensión de sus datos.

Entre las descripciones de las variables sería bueno el detalle de la que considera la más importante de su modelo, puede que tenga que calcular la media, por ejemplo, si mis datos son 

``` {r echo=FALSE, message=FALSE, warning=FALSE}
dat<- c(1:4)

kable(dat  , format = "latex" , booktabs=TRUE , align = 'clcc' , caption = "Ejemplo de formato para tabla",)%>%
  kable_styling(full_width = F, position = "center", latex_options = "HOLD_position")
```

\chapter{Metodología}
Cómo implementa la teoría expuesta en el marco teórico con sus datos, colocaremos aquí los resultados que se vayan obteniendo, incluir al menos un gráfico.



\chapter{Conclusiones y recomendaciones}
``` {r echo=FALSE, message=FALSE, warning=FALSE}
### Se procede a calcular a los parametros

## Se guaradan los datos importantes
t<-c(0,0,0,0.0003)
fitting<-fitNS(t,promedios$Maduration,promedios$Rendimiento)
paramters<-unlist(fitting[1])
### Ploteamos
time<-seq(from=0,to=360,by=1)
ggplot()+geom_line(aes(x=time,y=NS(paramters,time)))+geom_point(aes(x=promedios$Maduration,y=promedios$Rendimiento))
```
\chapter{Referencias bibliográficas}
En formato apa.

\chapter{Anexos}





